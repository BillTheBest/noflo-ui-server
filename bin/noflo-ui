#!/usr/bin/env coffee
# vim: set filetype=coffee:
path = require 'path'
app = require '../src/app'
project = require '../src/project'

unless process.argv.length is 3
  console.log "Usage: $ noflo-ui my/project/path"
  process.exit 0

projectDir = path.resolve process.cwd(), process.argv[2]
port = 3000

project.readProject projectDir, (err, projectData) ->
  return console.error err if err

  app.createServer projectDir, (err, server) ->
    return console.error err if err

    project.getGraphs projectData, (err, graphs) ->
      return console.error err if err

      server.graphs.push graph for graph in graphs
      server.listen port, (err) ->
        console.log "NoFlo listening at port #{port}"
